<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Aura Office</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; font-family: system-ui, sans-serif; }
    body {
      background: #fff7ed;
      height: 100vh;
      overflow: hidden;
      position: relative;
    }
    .logo {
      position: absolute; top: 20px; left: 24px; width: 40px; height: 40px;
      background: url('image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><rect width="512" height="512" fill="white"/><path d="M256 100 L300 220 L420 240 L320 280 L300 400 L212 400 L192 280 L92 240 L212 220 Z" fill="%23fb923c"/><path d="M256 140 L290 200 L380 215 L310 245 L295 335 L217 335 L202 245 L122 215 L212 200 Z" fill="%23fed7aa"/><text x="256" y="480" text-anchor="middle" font-family="system-ui" font-size="50" fill="%230f172a">Aura</text></svg>') center/contain no-repeat;
      background-size: 38px; padding: 12px; border-radius: 16px; box-shadow: 0 6px 20px rgba(251,146,60,0.3); z-index: 999; opacity: 0.5;
    }
    #welcome, #editor-screen, #excel-screen { display: none; }
    #editor-screen.active, #excel-screen.active, #welcome.active { display: block; }

    /* –î–æ–∫—É–º–µ–Ω—Ç-—Ä–µ–∂–∏–º */
    #editor-screen {
      position: absolute; top: 0; left: 0; width: 100%; height: 100vh; background: white;
    }
    .topbar {
      position: fixed; top: 0; left: 0; right: 0; height: 70px; background: white;
      display: flex; flex-wrap: wrap; gap: 8px; padding: 0 15px; align-items: center;
      border-bottom: 1px solid #eee; z-index: 99;
    }
    .btn {
      padding: 8px 16px; border: none; border-radius: 12px; background: #fb923c; color: white;
      font-weight: 600; cursor: pointer; box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      transition: all 0.2s;
    }
    .btn:hover { transform: translateY(-2px); box-shadow: 0 6px 12px rgba(0,0,0,0.15); }
    #editor { width: 100%; height: calc(100vh - 130px); padding: 80px 100px 50px; outline: none; background: #fff7ed; }

    /* Excel-—Ä–µ–∂–∏–º */
    #excel-screen {
      position: absolute; top: 0; left: 0; width: 100%; height: 100vh;
      background: white;
    }
    .excel-toolbar {
      display: flex; align-items: center; padding: 0 10px; height: 40px;
      background: #f1f3f4; border-bottom: 1px solid #dadce0;
    }
    .cell-address { 
      width: 80px; padding: 0 8px; background: white; border: 1px solid #dadce0; 
      text-align: center; font-family: monospace;
    }
    .formula-bar {
      flex: 1; padding: 0 8px; background: white; border: 1px solid #dadce0;
      outline: none; font-family: monospace; font-size: 14px;
    }
    .header-row {
      display: flex; position: sticky; top: 70px; left: 0; background: #f1f3f4;
    }
    .col-header {
      width: 80px; height: 24px; display: flex; align-items: center; justify-content: center;
      border-right: 1px solid #e0e0e0; border-bottom: 1px solid #e0e0e0;
      font-size: 12px; font-weight: bold;
    }
    .row-number {
      position: sticky; left: 0; width: 40px; height: 24px;
      display: flex; align-items: center; justify-content: center;
      background: #f1f3f4; border-right: 1px solid #e0e0e0;
      font-size: 12px; z-index: 5;
    }
    .excel-grid {
      display: grid; grid-template-columns: repeat(26, 80px); gap: 0;
    }
    .cell {
      width: 80px; height: 24px; border-right: 1px solid #e0e0e0; border-bottom: 1px solid #e0e0e0;
      padding: 2px 4px; outline: none; font-size: 13px; background: white;
    }
    .cell:focus {
      background: #e8f0fe; border: 1px solid #1a73e8;
    }
    .status { position: fixed; bottom: 0; left: 0; right: 0; padding: 10px; text-align: center; color: #555; }
  </style>
</head>
<body>

<div class="logo" title="Aura"></div>

<div id="welcome" class="active">
  <div style="height:100vh;display:grid;place-items:center;text-align:center">
    <div>
      <h1 style="font-size:5rem;color:#ea580c">Aura</h1>
      <p style="font-size:1.5rem;margin:1.5rem 0">–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –æ—Ñ–∏—Å —Å end-to-end —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º</p>
      <button id="start" style="padding:1.4rem 4rem;font-size:1.7rem;background:#ea580c;color:white;border:none;border-radius:999px;cursor:pointer">–°–æ–∑–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç ‚Üí</button>
    </div>
  </div>
</div>

<div id="editor-screen">
  <div class="topbar">
    <button data-cmd="bold">–ñ</button>
    <button data-cmd="italic">–ö</button>
    <button data-cmd="underline">–ü</button>
    <button data-cmd="strike">–ó–∞—á</button>
    <button data-cmd="bulletList">‚Ä¢</button>
    <button data-cmd="orderedList">1.</button>
    <button data-cmd="taskList">‚òë</button>
    <button data-cmd="insertTable">–¢–∞–±–ª–∏—Ü–∞</button>
    <button id="export-pdf">üìÑ PDF</button>
    <button id="export-html">üì§ HTML</button>
    <button id="import-html">üì• –ò–º–ø–æ—Ä—Ç</button>
    <button id="print-btn">üñ®Ô∏è –ü–µ—á–∞—Ç—å</button>
    <button id="cipher-btn">üîí QR</button>
    <button id="share-btn">‚úâÔ∏è –ü–æ–¥–µ–ª–∏—Ç—å—Å—è</button>
    <button id="aur-excel">üìä AurExcel</button>
    <button id="theme-btn">üåô –¢–µ–º–∞</button>
  </div>
  <div id="editor" contenteditable="true">–ù–∞—á–Ω–∏—Ç–µ –ø–∏—Å–∞—Ç—å...</div>
  <div class="status">–ó–∞—â–∏—â—ë–Ω–Ω–∞—è –∫–æ–º–Ω–∞—Ç–∞ –∞–∫—Ç–∏–≤–Ω–∞ ‚Äî —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ AES-256-GCM</div>
</div>

<div id="excel-screen">
  <div class="topbar">
    <button id="back-to-editor">üìÑ –î–æ–∫—É–º–µ–Ω—Ç</button>
    <button>Œ£ –°—É–º–º–∞</button>
    <button>‚åÄ –°—Ä–µ–¥–Ω–µ–µ</button>
    <button>–§–∏–ª—å—Ç—Ä</button>
  </div>
  <div class="excel-toolbar">
    <div class="cell-address">A1</div>
    <input class="formula-bar" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ñ–æ—Ä–º—É–ª—É –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ">
  </div>
  <div class="header-row" id="col-headers"></div>
  <div class="excel-grid" id="excel-grid"></div>
  <div class="status">–†–µ–∂–∏–º: AurExcel ‚Äî –ø–æ–ª–Ω—ã–π Excel-–∫–ª–æ–Ω</div>
</div>

<script>
let currentCell = null;

function createExcelGrid() {
  const colHeaders = document.getElementById('col-headers');
  const grid = document.getElementById('excel-grid');
  colHeaders.innerHTML = '';
  grid.innerHTML = '';

  // –ó–∞–≥–æ–ª–æ–≤–∫–∏ —Å—Ç–æ–ª–±—Ü–æ–≤ A-Z
  for (let i = 0; i < 26; i++) {
    const letter = String.fromCharCode(65 + i);
    const th = document.createElement('div');
    th.className = 'col-header';
    th.textContent = letter;
    colHeaders.appendChild(th);
  }

  // –Ø—á–µ–π–∫–∏ 100x26
  for (let row = 1; row <= 100; row++) {
    const rn = document.createElement('div');
    rn.className = 'row-number';
    rn.textContent = row;
    grid.appendChild(rn);
    for (let col = 0; col < 26; col++) {
      const letter = String.fromCharCode(65 + col);
      const cell = document.createElement('div');
      cell.className = 'cell';
      cell.contentEditable = 'true';
      cell.setAttribute('data-addr', `${letter}${row}`);
      cell.addEventListener('focus', () => {
        currentCell = cell;
        document.querySelector('.cell-address').textContent = cell.getAttribute('data-addr');
        document.querySelector('.formula-bar').value = cell.textContent;
      });
      cell.addEventListener('input', () => {
        if (currentCell === cell) {
          document.querySelector('.formula-bar').value = cell.textContent;
        }
      });
      grid.appendChild(cell);
    }
  }
}

// –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤
document.getElementById('start').onclick = () => {
  document.getElementById('welcome').classList.remove('active');
  document.getElementById('editor-screen').classList.add('active');
};

document.getElementById('aur-excel').onclick = () => {
  document.getElementById('editor-screen').classList.remove('active');
  document.getElementById('excel-screen').classList.add('active');
  createExcelGrid();
};

document.getElementById('back-to-editor').onclick = () => {
  document.getElementById('excel-screen').classList.remove('active');
  document.getElementById('editor-screen').classList.add('active');
};

// –ü—Ä–æ—Å—Ç—ã–µ –∫–æ–º–∞–Ω–¥—ã
document.querySelectorAll('[data-cmd]').forEach(btn => {
  btn.onclick = () => {
    const cmd = btn.dataset.cmd;
    if (cmd === 'insertTable') {
      document.execCommand('insertHTML', false, '<table border="1" style="border-collapse:collapse;width:100%"><tr><td>A1</td><td>B1</td></tr></table>');
    } else {
      document.execCommand(cmd, false, null);
    }
  };
});

// –ö–Ω–æ–ø–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞ ‚Äî –∑–∞–≥–ª—É—à–∫–∏
document.getElementById('export-pdf').onclick = () => alert('PDF —ç–∫—Å–ø–æ—Ä—Ç (–±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω)');
</script>
</body>
</html>
